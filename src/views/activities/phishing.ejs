<div id="phishing-container">
    <h2>>> IDENTIFY_THREAT</h2>
    <p>WHICH OPTION IS THE PHISHING ATTEMPT?</p>
    
    <div class="options-grid">
        <button class="cyber-button" onclick="selectOption('A')" id="btn-A">>> OPTION_A</button>
        <button class="cyber-button" onclick="selectOption('B')" id="btn-B">>> OPTION_B</button>
    </div>
    
    <h3>>> DETECTED_RED_FLAGS</h3>
    <div class="red-flags-list">
        <label class="cyber-checkbox">
            <input type="checkbox" value="suspicious_sender"> SUSPICIOUS_SENDER_Address
        </label>
        <label class="cyber-checkbox">
            <input type="checkbox" value="urgent_language"> URGENT_LANGUAGE
        </label>
        <label class="cyber-checkbox">
            <input type="checkbox" value="unexpected_link"> UNEXPECTED_LINK
        </label>
        <label class="cyber-checkbox">
            <input type="checkbox" value="grammar_errors"> GRAMMAR_ERRORS
        </label>
        <label class="cyber-checkbox">
            <input type="checkbox" value="personal_info_request"> REQUEST_FOR_PERSONAL_INFO
        </label>
        <label class="cyber-checkbox">
            <input type="checkbox" value="mismatched_branding"> MISMATCHED_BRANDING
        </label>
    </div>

    <button id="submit-btn" class="cyber-button action-btn" onclick="submitPhishing()" disabled>>> SUBMIT_ANALYSIS</button>
    
    <div id="phishing-status" style="margin-top:20px; display:none;">
        ANALYSIS_UPLOADED. SYSTEM_LOCKED.
    </div>
</div>

<script>
    let selectedOption = null;

    function selectOption(option) {
        selectedOption = option;
        document.querySelectorAll('.options-grid .cyber-button').forEach(btn => {
            btn.style.background = 'black';
            btn.style.color = 'white';
        });
        document.getElementById('btn-' + option).style.background = 'white';
        document.getElementById('btn-' + option).style.color = 'black';
        checkSubmit();
    }

    // Monitor checkboxes
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', checkSubmit);
    });

    function checkSubmit() {
        const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;
        const btn = document.getElementById('submit-btn');
        if (selectedOption && checked > 0) {
            btn.disabled = false;
            btn.style.opacity = '1';
        } else {
            btn.disabled = true;
            btn.style.opacity = '0.5';
        }
    }

    async function submitPhishing() {
        const redFlags = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
        
        try {
            const response = await fetch('/activity/phishing/respond', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ choice: selectedOption, redFlags: redFlags })
            });
            
            if (response.ok) {
                document.getElementById('phishing-container').innerHTML = document.getElementById('phishing-status').innerHTML;
                document.getElementById('phishing-status').style.display = 'block';
            }
        } catch (e) {
            console.error(e);
            alert("TRANSMISSION_ERROR");
        }
    }
</script>

<style>
    .options-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 20px;
    }
    .red-flags-list {
        text-align: left;
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 20px;
    }
    .cyber-checkbox {
        display: block;
        padding: 5px;
        cursor: pointer;
    }
    .action-btn {
        margin-top: 20px;
        border-color: #00ff00; /* Subtle matrix green hint? Or stick to bw */
        border-color: black;
    }
</style>
